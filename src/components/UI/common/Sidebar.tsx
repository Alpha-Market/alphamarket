"use client";

import useAuth from "@/features/auth/hooks/useAuth";

import useUser from "@/hooks/useUser";
import { cn } from "@/lib/utils";
import { TABS } from "@/util/constants";
import { DefaultUserProfilePicture } from "@/util/Icons";
import Image from "next/image";
import { useRouter, useSearchParams } from "next/navigation";

const className = {
	listItem: "flex items-center gap-3 cursor-pointer hover:bg-gray-600 p-3 rounded-[8px]",
} as const;

const ListItemCSSClass = className.listItem;

export default function Sidebar() {
	const router = useRouter();
	const tab = useSearchParams().get("tab");

	const [user] = useUser();

	const { signOut } = useAuth();

	return (
		<div className="w-[280px] flex flex-col justify-between p-6 max-h-[calc(100vh-70px)] border-r border-stroke-1">
			<ul className="flex flex-col gap-3">
				<li
					className={ListItemCSSClass}
					onClick={() => {
						router.push("/home?tab=home");
					}}
				>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width={20}
						height={20}
						viewBox="0 0 16 16"
						fill="none"
					>
						<path
							d="M8.66667 12.6668H12.6667V6.65218L8 3.02285L3.33333 6.65218V12.6668H7.33333V8.66685H8.66667V12.6668ZM14 13.3335C14 13.5103 13.9298 13.6799 13.8047 13.8049C13.6797 13.9299 13.5101 14.0002 13.3333 14.0002H2.66667C2.48986 14.0002 2.32029 13.9299 2.19526 13.8049C2.07024 13.6799 2 13.5103 2 13.3335V6.32685C1.99993 6.22526 2.02308 6.12499 2.06768 6.03371C2.11228 5.94244 2.17715 5.86256 2.25733 5.80018L7.59067 1.65218C7.7077 1.56114 7.85173 1.51172 8 1.51172C8.14827 1.51172 8.2923 1.56114 8.40933 1.65218L13.7427 5.80018C13.8229 5.86256 13.8877 5.94244 13.9323 6.03371C13.9769 6.12499 14.0001 6.22526 14 6.32685V13.3335Z"
							fill="white"
							fillOpacity={tab === TABS[0] ? "1" : "0.6"}
						/>
					</svg>

					<p
						className={cn(
							"text-xl",
							tab === TABS[0]
								? "text-white font-bold"
								: "text-secondary-1 font-normal",
						)}
					>
						Home
					</p>
				</li>

				<li
					className={ListItemCSSClass}
					onClick={() => {
						router.push("/home?tab=hosts");
					}}
				>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width={20}
						height={20}
						viewBox="0 0 16 16"
						fill="none"
					>
						<path
							d="M0.666687 14.6665C0.666687 13.252 1.22859 11.8954 2.22878 10.8952C3.22898 9.89503 4.58553 9.33313 6.00002 9.33313C7.41451 9.33313 8.77106 9.89503 9.77126 10.8952C10.7715 11.8954 11.3334 13.252 11.3334 14.6665H10C10 13.6056 9.57859 12.5882 8.82845 11.838C8.0783 11.0879 7.06089 10.6665 6.00002 10.6665C4.93915 10.6665 3.92174 11.0879 3.17159 11.838C2.42145 12.5882 2.00002 13.6056 2.00002 14.6665H0.666687ZM6.00002 8.66646C3.79002 8.66646 2.00002 6.87646 2.00002 4.66646C2.00002 2.45646 3.79002 0.666461 6.00002 0.666461C8.21002 0.666461 10 2.45646 10 4.66646C10 6.87646 8.21002 8.66646 6.00002 8.66646ZM6.00002 7.33313C7.47335 7.33313 8.66669 6.13979 8.66669 4.66646C8.66669 3.19313 7.47335 1.99979 6.00002 1.99979C4.52669 1.99979 3.33335 3.19313 3.33335 4.66646C3.33335 6.13979 4.52669 7.33313 6.00002 7.33313ZM14.3654 0.522461C15.0042 1.81035 15.3355 3.22886 15.3334 4.66646C15.3334 6.15513 14.9847 7.56246 14.3654 8.81046L13.2687 8.01313C13.7522 6.96377 14.0017 5.82184 14 4.66646C14 3.47179 13.738 2.33779 13.2687 1.31979L14.3654 0.522461ZM12.164 2.12246C12.497 2.92923 12.6678 3.79368 12.6667 4.66646C12.6678 5.53924 12.497 6.40369 12.164 7.21046L11.046 6.39713C11.2368 5.84008 11.3339 5.25527 11.3334 4.66646C11.3341 4.07769 11.2372 3.49288 11.0467 2.93579L12.164 2.12246Z"
							fill="white"
							fillOpacity={tab === TABS[1] ? "1" : "0.6"}
						/>
					</svg>

					<p
						className={cn(
							"text-xl",
							tab === TABS[1]
								? "text-white font-bold"
								: "text-secondary-1 font-normal",
						)}
					>
						Hosts
					</p>
				</li>

				<li
					className={ListItemCSSClass}
					onClick={() => {
						router.push("/home?tab=chats");
					}}
				>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width={20}
						height={20}
						viewBox="0 0 16 16"
						fill="none"
					>
						<path
							d="M6.66663 9.78446V9.74312C6.66663 8.07112 8.01063 6.66446 9.83529 6.25446C9.59263 4.71979 7.97263 3.46712 5.93329 3.46712C3.71996 3.46712 1.99996 4.94246 1.99996 6.65379C1.99996 7.29979 2.23996 7.92046 2.69329 8.45246C2.71463 8.47779 2.74863 8.51512 2.79463 8.56246C3.18656 8.96526 3.42321 9.49382 3.46263 10.0545C3.93869 9.77924 4.49461 9.67526 5.03796 9.75979C5.14863 9.77712 5.23929 9.79046 5.30796 9.79979C5.75934 9.85842 6.21675 9.85304 6.66663 9.78379V9.78446ZM6.97129 11.0851C6.36481 11.1893 5.74612 11.2016 5.13596 11.1218C5.03489 11.1081 4.934 11.0932 4.83329 11.0771C4.58414 11.0383 4.32928 11.0883 4.11329 11.2185L2.84396 11.9838C2.7462 12.044 2.63172 12.0714 2.51729 12.0618C2.44809 12.0566 2.38059 12.0377 2.31868 12.0064C2.25677 11.975 2.20166 11.9317 2.15651 11.879C2.11136 11.8263 2.07706 11.7652 2.05557 11.6992C2.03408 11.6332 2.02583 11.5636 2.03129 11.4945L2.13129 10.3071C2.14375 10.1582 2.12407 10.0083 2.07358 9.86765C2.02309 9.72698 1.94296 9.5988 1.83863 9.49179C1.78321 9.4353 1.72963 9.37705 1.67796 9.31712C1.04196 8.57046 0.666626 7.64912 0.666626 6.65312C0.666626 4.15712 3.02463 2.13379 5.93329 2.13379C8.63996 2.13379 10.8686 3.88512 11.1666 6.13912C13.4146 6.24112 15.2 7.81579 15.2 9.74312C15.2 10.5385 14.896 11.2738 14.3806 11.8698C14.3466 11.9098 14.3033 11.9565 14.2506 12.0098C14.1664 12.0946 14.1015 12.1967 14.0605 12.3091C14.0196 12.4214 14.0034 12.5413 14.0133 12.6605L14.094 13.6091C14.098 13.6647 14.0911 13.7206 14.0735 13.7736C14.0559 13.8265 14.0281 13.8754 13.9915 13.9175C13.955 13.9597 13.9105 13.9942 13.8605 14.019C13.8106 14.0439 13.7563 14.0587 13.7006 14.0625C13.608 14.07 13.5153 14.0481 13.436 13.9998L12.4073 13.3885C12.2319 13.2847 12.026 13.2449 11.8246 13.2758C11.7266 13.2911 11.6446 13.3025 11.5793 13.3111C11.3686 13.3378 11.1526 13.3525 10.9333 13.3525C9.13729 13.3525 7.60129 12.4138 6.97129 11.0851ZM11.6226 11.9585C11.9989 11.9005 12.3837 11.9405 12.74 12.0745C12.8334 11.6964 13.0271 11.3504 13.3006 11.0731C13.334 11.0398 13.3586 11.0131 13.3713 10.9985C13.6973 10.6218 13.8666 10.1898 13.8666 9.74312C13.8666 8.54046 12.598 7.46712 10.9333 7.46712C9.26863 7.46712 7.99996 8.54046 7.99996 9.74312C7.99996 10.9458 9.26863 12.0191 10.9333 12.0191C11.094 12.0191 11.2533 12.0085 11.4093 11.9885C11.4626 11.9818 11.5346 11.9718 11.6226 11.9578V11.9585Z"
							fill="white"
							fillOpacity={tab === TABS[2] ? "1" : "0.6"}
						/>
					</svg>

					<p
						className={cn(
							"text-xl",
							tab === TABS[2]
								? "text-white font-bold"
								: "text-secondary-1 font-normal",
						)}
					>
						Chats
					</p>
				</li>
			</ul>

			<div className="flex items-center gap-3">
				{
					(user?.profile_picture_url || user?.twitter_avatar_url)
						? (
								<Image
									src={(user?.profile_picture_url || user?.twitter_avatar_url) as string}
									alt="User Profile Pic"
									width={45}
									height={45}
									className="w-[45px] h-[45px] rounded-full"
								/>
							)
						: <DefaultUserProfilePicture width="50" height="50" color="rgba(255, 255, 255, 0.60)" />
				}

				<div className="flex-1 flex flex-col gap-1">
					<h4 className="text-secondary-1 text-sm font-semibold">
						{user?.name || user?.twitter_handle}
					</h4>
					{/* <p className="text-secondary-1 text-sm font-normal"> */}
					{/*	{user?.email || ""} */}
					{/* </p> */}

					<button
						type="button"
						onClick={() => {
							signOut();
						}}
						className="button-primary-base p-2 rounded-[5px]"
					>
						Signout
					</button>
				</div>
			</div>
		</div>
	);
}
